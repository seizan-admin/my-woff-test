<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>WOFF Test</title>
  <script src="https://static.worksmobile.net/static/wm/woff/edge/3.6/sdk.js"></script>
</head>
<body>

<!-- 有効画面（WOFF経由のみ） -->
<div id="valid" style="display:none;">
  <h1 style="color: blue;">WOFFテスト成功！</h1>
  <p id="user-info">読み込み中...</p>
</div>

<!-- 無効画面（直アクセス等） -->
<div id="invalid" style="display:none; color:red;">
  <h1>無効なアクセス</h1>
  <p>
    このページは LINE WORKS の WOFF からのみ利用できます。
  </p>
</div>

<script>
  const MY_WOFF_ID = "r2Ff5XMgxVdYKkWtq0XgVA";

  function showValid() {
    document.getElementById("valid").style.display = "block";
    document.getElementById("invalid").style.display = "none";
  }

  function showInvalid() {
    document.getElementById("valid").style.display = "none";
    document.getElementById("invalid").style.display = "block";
  }

  // --- WOFF 初期化 ---
  woff.init({ woffId: MY_WOFF_ID })
    .then(() => {
      // ✅ WOFF 経由
      showValid();

      // プロフィール取得
      return woff.getProfile();
    })
    .then(profile => {
      document.getElementById("user-info").innerText =
        profile.displayName + "さん、こんにちは！";
    })
    .catch(err => {
      // ❌ WOFF ではない（直アクセス・URL不一致など）
      console.warn("WOFF init failed:", err);
      showInvalid();
    });
</script>

</body>
</html>
